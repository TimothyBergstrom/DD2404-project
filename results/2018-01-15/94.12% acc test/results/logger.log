2018-01-15 06:31:23,673 - __main__ - INFO - --------------------START OF RUN--------------------
2018-01-15 06:31:23,674 - __main__ - INFO - {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x0000027603B0AAC8>, '__spec__': None, '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': 'NN.py', '__cached__': None, 'use_gpu': True, 'load_saved_array': False, 'data_folder': '../data/training_data', 'equalize_data': True, 'save_array': True, 'seq_length': 30, 'data_augmentation': False, 'fix_samples': 'IGNORE', 'vectorize': True, 'use_ascii': False, 'load_saved_model': False, 'train_loaded_model': False, 'choosen_model': 2, 'train_test_split': 0.8, 'train_val_split': 0.8, 'limit_samples': None, 'lr': 0.0001, 'decay': 1.1e-05, 'momentum': 0.5, 'epochs': 3000, 'batch_size': 4096, 'use_lr_scheduler': True, 'lr_scheduler_plan': {}, 'config_plot_realtime': True, 'plot_realtime_interval': 1, 'plot_performance': False, 'train_GAN': True, 'load_trained_GAN': True, 'GAN_lr': 0.0001, 'GAN_epochs': 3000, 'GAN_batch_size': 512, 'GAN_limit_samples': None, 'argparse': <module 'argparse' from 'F:\\Python\\lib\\argparse.py'>, 'parser': ArgumentParser(prog='NN.py', usage=None, description='Keras based program that predicts Signal Peptides', formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True), 'args': Namespace(), 'logging': <module 'logging' from 'F:\\Python\\lib\\logging\\__init__.py'>, 'os': <module 'os' from 'F:\\Python\\lib\\os.py'>, 'logger': <Logger __main__ (INFO)>, 'handler': <FileHandler C:\Users\Timothy''s PC\OneDrive\Dokument\GitHub\DD2404-project\bin\results\logger.log (INFO)>, 'formatter': <logging.Formatter object at 0x0000027603D52E48>}
2018-01-15 06:32:59,131 - __main__ - INFO - Using gpu...
2018-01-15 06:33:12,951 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,952 - __main__ - INFO - Layer (type)                 Output Shape              Param #   
2018-01-15 06:33:12,952 - __main__ - INFO - =================================================================
2018-01-15 06:33:12,953 - __main__ - INFO - bidirectional_1 (Bidirection (None, 30, 128)           44032     
2018-01-15 06:33:12,953 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,953 - __main__ - INFO - dropout_1 (Dropout)          (None, 30, 128)           0         
2018-01-15 06:33:12,953 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,954 - __main__ - INFO - bidirectional_2 (Bidirection (None, 128)               98816     
2018-01-15 06:33:12,954 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,954 - __main__ - INFO - dropout_2 (Dropout)          (None, 128)               0         
2018-01-15 06:33:12,955 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,955 - __main__ - INFO - dense_1 (Dense)              (None, 1)                 129       
2018-01-15 06:33:12,955 - __main__ - INFO - =================================================================
2018-01-15 06:33:12,955 - __main__ - INFO - Total params: 142,977
2018-01-15 06:33:12,955 - __main__ - INFO - Trainable params: 142,977
2018-01-15 06:33:12,956 - __main__ - INFO - Non-trainable params: 0
2018-01-15 06:33:12,956 - __main__ - INFO - _________________________________________________________________
2018-01-15 06:33:12,956 - __main__ - INFO - Input shape: (None, 30, 21)
2018-01-15 06:33:12,956 - __main__ - INFO - Output shape: (None, 1)
2018-01-15 06:34:18,430 - scripts.load_data - INFO - Loaded 1138012 samples
2018-01-15 06:35:14,987 - scripts.load_data - INFO - Dataset is 2867.79024 mb in memory
2018-01-15 06:35:14,993 - scripts.load_data - INFO - 567546 positive samples and 570466 negative samples
2018-01-15 06:35:14,993 - scripts.load_data - INFO - It took 121.00498 seconds to load
2018-01-15 06:35:15,060 - scripts.load_data - INFO - More negative than positive samples. Removing 2920 negative samples
2018-01-15 06:35:17,797 - scripts.load_data - INFO - Equalized, removed 2920 samples
2018-01-15 06:35:17,806 - scripts.load_data - INFO - 567546 positive samples and 567546 negative samples
2018-01-15 06:35:17,807 - scripts.load_data - INFO - It took 2.81273 seconds to equalize
2018-01-15 06:35:17,807 - scripts.load_data - INFO - Saving array to file...
2018-01-15 06:35:47,470 - __main__ - INFO - Train set: 362844 positive samples and 363615 negative samples
2018-01-15 06:35:47,472 - __main__ - INFO - Validation set: 91098 positive samples and 90517 negative samples
2018-01-15 06:35:47,475 - __main__ - INFO - Test set: 113604 positive samples and 113414 negative samples
2018-01-15 06:35:47,477 - __main__ - INFO - Press ctrl+c to stop training early
2018-01-15 18:36:17,048 - __main__ - INFO - 
Stopped training...
2018-01-15 18:36:25,085 - __main__ - INFO - It took 43237.60715 seconds to train
2018-01-15 18:36:25,085 - __main__ - INFO - Evaluation of model processing...
2018-01-15 18:41:35,546 - __main__ - INFO - 
binary_accuracy: 94.12%
2018-01-15 18:41:35,546 - __main__ - INFO - Saving model...
2018-01-15 18:41:35,933 - __main__ - INFO - Plotting accuracy...
2018-01-15 18:41:36,188 - __main__ - INFO - Plotting loss...
2018-01-15 18:41:36,389 - __main__ - INFO - Creating confusion matrix on test samples...
2018-01-15 18:46:56,553 - __main__ - INFO - Creating ROC curve
2018-01-15 18:52:11,816 - __main__ - INFO - Calculating metrics
2018-01-15 18:52:11,817 - __main__ - INFO - Accuracy: 0.9412, Precision: 0.9258, Sensitivity: 0.9596, Specificity: 0.9229
2018-01-15 18:52:12,355 - __main__ - INFO - Bias of layer <keras.layers.wrappers.Bidirectional object at 0x000002761E276EF0> (21, 256)
2018-01-15 18:52:12,360 - __main__ - INFO - Output of layer <keras.layers.wrappers.Bidirectional object at 0x000002761E276EF0> (64, 256)
2018-01-15 18:52:12,536 - __main__ - INFO - Bias of layer <keras.layers.wrappers.Bidirectional object at 0x000002761E276C88> (128, 256)
2018-01-15 18:52:12,537 - __main__ - INFO - Output of layer <keras.layers.wrappers.Bidirectional object at 0x000002761E276C88> (64, 256)
2018-01-15 18:52:12,607 - __main__ - INFO - Bias of layer <keras.layers.core.Dense object at 0x000002767F764BE0> (128, 1)
2018-01-15 18:52:12,608 - __main__ - INFO - Output of layer <keras.layers.core.Dense object at 0x000002767F764BE0> (1,)
2018-01-15 18:52:12,892 - __main__ - INFO - Creating generator...
2018-01-15 18:52:13,199 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:13,200 - __main__ - INFO - Layer (type)                 Output Shape              Param #   
2018-01-15 18:52:13,200 - __main__ - INFO - =================================================================
2018-01-15 18:52:13,200 - __main__ - INFO - conv1d_1 (Conv1D)            (None, 11, 128)           53888     
2018-01-15 18:52:13,200 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:13,201 - __main__ - INFO - lstm_3 (LSTM)                (None, 64)                49408     
2018-01-15 18:52:13,201 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:13,201 - __main__ - INFO - dense_2 (Dense)              (None, 630)               40950     
2018-01-15 18:52:13,201 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:13,201 - __main__ - INFO - reshape_1 (Reshape)          (None, 30, 21)            0         
2018-01-15 18:52:13,201 - __main__ - INFO - =================================================================
2018-01-15 18:52:13,202 - __main__ - INFO - Total params: 144,246
2018-01-15 18:52:13,202 - __main__ - INFO - Trainable params: 144,246
2018-01-15 18:52:13,202 - __main__ - INFO - Non-trainable params: 0
2018-01-15 18:52:13,202 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:13,202 - __main__ - INFO - None
2018-01-15 18:52:13,203 - __main__ - INFO - Input shape: (None, 30, 21)
2018-01-15 18:52:13,203 - __main__ - INFO - Output shape: (None, 30, 21)
2018-01-15 18:52:13,203 - __main__ - INFO - Creating discriminator...
2018-01-15 18:52:14,257 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,257 - __main__ - INFO - Layer (type)                 Output Shape              Param #   
2018-01-15 18:52:14,257 - __main__ - INFO - =================================================================
2018-01-15 18:52:14,258 - __main__ - INFO - bidirectional_1 (Bidirection (None, 30, 128)           44032     
2018-01-15 18:52:14,258 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,258 - __main__ - INFO - dropout_1 (Dropout)          (None, 30, 128)           0         
2018-01-15 18:52:14,258 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,258 - __main__ - INFO - bidirectional_2 (Bidirection (None, 128)               98816     
2018-01-15 18:52:14,259 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,259 - __main__ - INFO - dropout_2 (Dropout)          (None, 128)               0         
2018-01-15 18:52:14,259 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,259 - __main__ - INFO - dense_1 (Dense)              (None, 1)                 129       
2018-01-15 18:52:14,259 - __main__ - INFO - =================================================================
2018-01-15 18:52:14,259 - __main__ - INFO - Total params: 142,977
2018-01-15 18:52:14,259 - __main__ - INFO - Trainable params: 142,977
2018-01-15 18:52:14,260 - __main__ - INFO - Non-trainable params: 0
2018-01-15 18:52:14,260 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:14,260 - __main__ - INFO - None
2018-01-15 18:52:14,260 - __main__ - INFO - Input shape: (None, 30, 21)
2018-01-15 18:52:14,260 - __main__ - INFO - Output shape: (None, 1)
2018-01-15 18:52:14,273 - __main__ - INFO - Compiling models...
2018-01-15 18:52:26,108 - __main__ - INFO - GAN models not found...
2018-01-15 18:52:26,109 - __main__ - INFO - Setting up GAN (generator + discriminator)
2018-01-15 18:52:26,860 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:26,860 - __main__ - INFO - Layer (type)                 Output Shape              Param #   
2018-01-15 18:52:26,862 - __main__ - INFO - =================================================================
2018-01-15 18:52:26,862 - __main__ - INFO - sequential_3 (Sequential)    (None, 30, 21)            144246    
2018-01-15 18:52:26,863 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:26,863 - __main__ - INFO - sequential_4 (Sequential)    (None, 1)                 142977    
2018-01-15 18:52:26,863 - __main__ - INFO - =================================================================
2018-01-15 18:52:26,864 - __main__ - INFO - Total params: 287,223
2018-01-15 18:52:26,864 - __main__ - INFO - Trainable params: 144,246
2018-01-15 18:52:26,864 - __main__ - INFO - Non-trainable params: 142,977
2018-01-15 18:52:26,865 - __main__ - INFO - _________________________________________________________________
2018-01-15 18:52:26,865 - __main__ - INFO - None
2018-01-15 18:52:26,865 - __main__ - INFO - Input shape: (None, 30, 21)
2018-01-15 18:52:26,866 - __main__ - INFO - Output shape: (None, 1)
2018-01-15 18:52:26,866 - __main__ - INFO - Fixing real data...
2018-01-15 18:52:27,614 - __main__ - INFO - ----------Iteration 0----------
